<!DOCTYPE html>
<html lang="en-us">

<head>
  <meta charset="utf-8" />

  <!--	<base href="https://neandr.github.io/piSchedule/" >  ??? -->
  <title>piSchedule Overview</title>


  <!--  CSS Setup -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.0/css/bootstrap.min.css">
  <link rel="stylesheet" href="../pischedule.css">
  <style type="text/css">
    body {
      margin-left: 4%;
      margin-right: 8%;
    }
  </style>

</head>

<body>
  <div id="XXgoogle_translate_element"></div>

  <div class="container container-site">
    <!-- $$$content$$$ -->

    <h2 id="pischedule-plus">
      <em><strong>piSchedule <small> &nbsp; Overview</small></strong></em>
      <p style="text-align: right; margin-top: -50px; padding-bottom: 20px;">
        <small><small><a href="../DE/de.index.html">Deutsche Version </a></small></small>
        <img title="English" src="pict/pic.flagDE.png" align="bottum">
      </p>
      <h4 id="hLine2"><em> Flexible Lighting Switching with WLAN / Tasmota <small> . schedulePlus3 2020-10-24</small></em></h4>
    </h2>
    <hr>



    <p><strong><em>piSchedule</em></strong> is an application for the time-controlled switching of devices according to definable daily schedules, which can vary with sunrise / sunset as well as random times. Presence and activity can be simulated
      with this variably designed house lighting.</p>

    <p><strong><em>piSchedule</em></strong> is an easy-to-use browser application that runs on smartphones, tablets or PCs. Settings, operation, tracking of messages or calling up the documentation are carried out by means of menu control.</p>

    <p><strong><em>piSchedule</em></strong> is aimed at users who, after the initial installation, want to carry out time-controlled switching as well as adapting the daily schedule with the usual elements of a smartphone or PC.</p>

    <p><img title="piSchedule Start Page" src="pict/pic.en.startPage7.png" hspace="45" width="450"></p>

    <p>See also <b><a href="en.scheduleOverview.html#web"><em>piSchedule</em> on Smartphone and PC</a></b></p>

    <p><strong><em>piSchedule</em></strong> is a Python program that is installed on a RaspberryPI (RPI)
      <a href="en.schedule7Setup.html"> ▸ Description of the setup </a>.
      After installation, the use of the RPI console is typically no longer required. The console can be used to display log messages, among other things. The console maybe used for log messages.
    </p>
    <hr>

    <h3 id="timeSwitching"> pilight Switching with Time Schedule -- <em>Overview</em></h3>
    <p><em>piSchedule</em> offers a simple menu driven concept for operation.</p>

    <h4 id="jobDefinition"> Job Definition</h4>
    <p>With <strong><em>piSchedule</em></strong> the user defines at what <code>time</code> which <code>device</code> has to be switched <code>on/off</code> -- such a definition is called a <strong>Job</strong>. For the <code>time</code> definitions
      of a 'Job' a variety of methods are available, absolute time or relative to a previous defined time (eg. to switch off after a certain time period), or also relative to <code>sunrise/sunset</code>. All time values can be varied randomly also.
      Multiple actions for the same device can be handled with one 'Job'. </p>

    <h4 id="dayPlanDefinition"> Day Schedule</h4>
    <p>A Day Schedule consists of configured 'Jobs'. The Day Schedule definition relates to one day and will be named and stored as a text file (extension .ini required) -- example <code>piSchedule.ini</code>.</p>

    <p>&nbsp; &nbsp; &nbsp; <img alt="piSchedule Start Page" src="pict/editDayplan.png"></p>

    <p>This illustration shows the use of the menu control to create jobs. The daily schedule can also be created with a simple text editor (vi, nano etc).</p>

    <p>For starting a day schedule the user selects one of those day schedule files from the menu list. That way that plan is activated and <strong><em>piSchedule</em></strong> will calculate the required switching times, taking into account the
      information related to sunrise, sunset and random times.
    </p>

    <p>With activation of a 'Job' also the resulting time information is checked for consistency.
      If an already elapsed time is calculated for a job, this is ignored and logged in a <strong><em>piSchedule</em></strong> log file.</p>

    <p><em>(Detailed examples and additional technical aspects of the 'piSchedule jobs' are described
        in <a href="en.scheduleExamples.html"> ▸ Time control - examples</a>)</em></p>


    <h4 id="weekPlan"> Week Schedule</h4>
    <p>The week schedule can define different daily schedules for each weekday. If no day schedule for a given weekday is defined (or it's not valid) the day schedule of the previous weekday is used again. This way a definition of just two day
      schedules for Monday .. Friday and Saturday .. Sunday makes it easy to have a working days and a weekend schedule.</p>

    <p>The definition is made on the "Edit Daily / Weekly Plan" page.</p>

    <p><img title="piSchedule Start Page" src="pict/pic.en.weekSchedule7.png" hspace="45" width="450"></p>

    <p>For each day of the week, a 'Day Schedule' is selected from the available daily schedules in the menu. The choice of '--' removes a previously selected Day Plan, so that the Dail Plan of the previous weekday is used. </p>


    <h4 id="service"> <em>piSchedule</em> -- Settings / Preferences</h4>
    <p>With starting of <em><strong>piSchedule</strong></em> the following parameters -- the preference are retrieved:</p>
    <ul>
      <li>
        <p><strong>Location</strong> is the place where <em>piSchedule</em> is installed. This is used to calculate sunrise/sunset on a daily basis.</p>
      </li>
      <li>
        <strong>Language</strong> (locale) Language code/-version. The language version is retrieved from the installation,
        but can changed with the browser (web-GUI).<br /> Currently <em>piSchedule</em> supports DE for German and EN for English.<br />
        Other languages are possible with adapting a JSON file.
      </li>
      <li>
        <p><strong>Server/Port</strong> Automatic retrieve of the networking details</p>
      </li>
    </ul>
    <!--
    <p><small><em><strong>Hinweis</strong> &nbsp; &nbsp; All parameters/preferences are stored to the file
    	<code>piSchedule.prefs.json</code>.<br />
    	Using the browser web-GUI with ('/prefs') the data can be shown with
      <code>http://{server}:{port}/prefs</code> </em></small></p>
   -->


    <h4 id="startening-pischedule">Starting piSchedule</h4>
    <p><em><strong>piSchedule</strong></em> will be started on the RaspberryPi console with<br />
      <code>sudo service piSchedule start</code>
      <br /><em><strong>Important</strong></em>
    </p>
    <ul>
      <li>This will start <i>piSchedule</i> in the background but closing the console will not terminate <i>piSchedule</i>.</li>
      <li>Even after power failure and restart of the RPI <strong><em>piSchedule</em></strong> restarts automatically. A previously selected schedule is executed again.</li>
    </ul>

    <p>The further operation is done via the browser (Web-GUI). The start address for <em>piSchedule</em>
      is specified during installation in the form <br />
      <code>http://{server}:{port}/</code> &nbsp;
      or &nbsp; <code> {RPIname}:{port}/</code><br />

      The <code> RPIname </code> is defined in the router configuration.
      <br />
      At the console you can get this information with <br />
    <pre><code> $ ./systemAndPort.py
        ['raspberrypi:5005', '192.168.1.80:5005']     (example data)</code></pre>
    </p>

    <p>This entry in the address line of the browser starts <strong><em>piSchedule</em></strong>.</p>

    <p>&nbsp; &nbsp; &nbsp; <img alt="piSchedule Start Page" style='width:80%' src="pict/piScheduleStart.png"></p>



    <h4 id="stop-pischedule">Exit pischedule </h4>
    <p><strong><em>piSchedule</em></strong> is aborted on the RaspberryPI console with <br />
      <code>pi@raspberrypi / $ sudo service piSchedule stop</code>, <br />
      or cancel in the browser with: <code>http://{server}:{port}/close</code>.
      <br /> But a restart is only possible via the console!
    </p>
    <hr>


    <h3 id="web"> <em>piSchedule</em> on Smartphone/Tablet or PC</h3>
    <p>To operate <strong><em>piSchedule</em></strong> the browser is used.
      The console is only necessary with very limited situation like locking into the log files.</p>

    <p>The <strong><em>piSchedule</em></strong> start address
      <code>http://{server}:{port}</code> entered in the address field of the browser opens the <strong><em>piSchedule</em></strong> web page with the 'overview' of the known WLAN/Sonoff devices <em>(see also above)</em>.
    </p>

    <p><small><em><strong>Note </strong> &nbsp; &nbsp;
          The <img alt="info" src="pict/pic.ginfo.png"> info icon opens
          documentation on the context.</em></small></p>

    *****************************


    <h4 id="webGUI"> Overview Web Pages</h4>
    <ul>
      <li>

        <h4 id="mainMenu"> Main Menu / Home Page</h4>
        <p>&nbsp; &nbsp; &nbsp; <img alt="Home Page" style='width:60%' src="pict/home-0.jpg"></p>


        <p> The header is used for navigation. The opened menu provides access to the <strong><em>piSchedule</em></strong> functions. From there you can also return to the main menu (Overview/home).</em></small></p>
<br />
        <div style="margin-left: 25px;">
          <em><strong>Navigation with the Main Menu </strong><small> (Example: Display on a mobile device)</small></em></strong>
          <p>&nbsp; &nbsp; &nbsp; <img alt="Home Page" src="pict/home-with-menu1.jpg"></p>
          <br />
          <p>The lower part of the navigation menu offers support functions:
          </p>

          <ul>
            <li>
              <strong>Language</strong>
              <p>Select the language version for the WEB-GUI and the documentation.</p>
            </li>
            <li>
              <strong>Documentation</strong>
              <p>The documentation pages are opened on an extra WEB page or tab.
              </p>
            </li>
            <li>
              <strong>About piSchedule</strong>
              <p>&nbsp; &nbsp; &nbsp;
                <a href="../pict/pic.de.about_piSchedule.png">

                  <img alt="About piSchedule" src="pict/pic.de.about_piSchedule.th.png"></a>
                <small><em> &nbsp; &nbsp; Click to enlarge display</em></small>
              </p>
              <p>This menu item opens a page with the installation details,
                as well as calls to the piSchedule forum and to send a
                message to the developer.</p>
            </li>
          </ul>
        </div>

        <h4 id="dayPlan"> <em>Actual Day Schedule</em> <br />
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<small><em>(Location, Sunrise/Sunset, Geo-Coordinates)</em></small>
        </h4>

    <p>The current "Day Schedule" shows the calculated upcoming switching operations as defined in the current daily schedule. </p>


    <p>&nbsp; &nbsp; &nbsp; <img alt="Dayplan Selection"
    src="pict/actualDayplan.png"></p>
    <br />
    <p>The page has two sections:</p>

        <ol>
        <li>
          <p> <strong>Menu with buttons</strong> <br />

          ▸ The <strong>blue button</strong> &nbsp; &nbsp; serves as a menu for selecting and loading a saved daily schedule. After loading, the button shows the name of the selected schedule. For a selected daily plan, all times are recalculated; only the resulting switching times that lie after the current time are listed. <br />

          ▸ Icon <strong>Update</strong> &nbsp; &nbsp; The daily schedule is displayed with the jobs still pending. The times are not recalculated! <br />

          ▸ Icon <strong>Timeline</strong> &nbsp; &nbsp; The current daily schedule is displayed as a bar chart, a change of the individual jobs/switching processes is possible interactively on the screen. Details and operation see here: ▸ <strong><em><a href="xx">timeline</a></em></strong> <br />

          ▸ <strong>Daily Logs</strong> &nbsp; &nbsp; Shows a page with the executed jobs (see below) of the daily schedule. <br />

          ▸ The <img alt="plus" src="pict/pic.plus.png"> button is used to define additional jobs. However, these are only valid for the current day. If the daily schedule is reloaded, these added jobs are removed. To permanently add jobs to a daily schedule see <a href="xx">▸ Daily Schedule/Edit Jobs</a>. <br />

          ▸ The info icon <img alt="info" src="pict/pic.ginfo.png"> opens a help page for these functions. </p>

        <!--   <p>▸ <strong>TODO</strong>  Funktion zur vorübergehenden Abschaltung </p> -->
      </li>

      <li>
        <p><strong>Current switching operations</strong> of the day <br />
          This table shows all jobs still pending for the day. The table rows result from the resolution of the current daily schedule (see blue menu field above). <br />
          Next to the switching times, the ON or OFF instruction can be seen. With OFF statements, a bracket expression indicates the corresponding ON statement. <br />
          With the <img alt="minus" src="pict/pic.minus.png"> button in the table rows the switching process can be deleted.
          Again, this is only valid as long as the daily schedule is not reloaded.</p>
      </li>
    </ol>


    <h4><em>Job Lists Edit</em></h4>
    <p>With the main menu the creation or editing of daily plans / job lists is called up.</p>
    <p>&nbsp; &nbsp; &nbsp; <img alt="Edit Job Lists" src="pict/editPlans1.png"></p>

    <p>The blue menu button <strong>[Daily Plans]</strong> offers all existing daily plans (INI/text files) for processing the jobs. The opened plan allows to interactively create, edit and save daily plans (as INI/text file). <br />
      This function is described in detail under <a href="xx">▸ Edit Daily Schedule/Jobs</a></p>

    <h5>Examples for INI/Text and Prefs files</h5>
    <ul>
      <li><a href="xx">piSchedule.ini</a></li>
      <li><a href="xx">piSchedule.prefs.json</a></li>
    </ul>
    <br />

    <h4><em>Day Logs</em></h4>
    <p>&nbsp; &nbsp; &nbsp; <img alt="Day Logs" src="pict/dayLogs.png"></p>
    <p>Calling this page automatically loads a list of the <strong>[Today]</strong> already executed switching actions. <br />
      <strong>[Select day]</strong> &nbsp; &nbsp; -- Shows a menu with the weekdays to alternatively call up the list of another weekday. <br />
      piSchedule rewrites these log files every day in a weekly rhythm. <br />
    </p>


    <hr />
    <h3 id="setup"> <em>piSchedule</em> Setup</h3>

    <p><strong><em>piSchedule</em></strong> is a Python program, it runs on the RaspberryPi.</p>

    <p>The installation and an update of all <strong><em>piSchedule</em></strong> components is described in detail on the page
      <a href="en.xx.html">▸ <em>piSchedule Setup</em></a>
    </p>


    <h4><em>Start/Stop with 'service' on the RPI console</em></h4>

    <p>The 'service' command controls the execution of the <strong><em>piSchedule</em></strong> program on the RPI, see also:</p>
    <pre><code> pi@raspberrypi ~ $ sudo service piSchedule
      Usage: /etc/init.d/piSchedule {start|stop|restart|status}</code></pre>
    <p>The program System is executed in the background.</p>



----------------------


    <h4 id="preferences"> <em>piSchedule</em> Preferences</h4>
    <p><em>piSchedule</em> stores important parameter in a file "piSchedule.prefs.json" and at <em>piSchedule</em> start it reads the previous used parameters from that file. If the file is missing, <em>piSchedule</em> will retrieve those preferences
      and stores them for further use.</p>
    <p>The preference file <code>piSchedule.prefs.json</code> can be resetted at the console prompt with
      <br /> &nbsp; &nbsp; &nbsp; &nbsp; <code>sudo echo "{}" &gt; ~/schedulePlus3/piSchedule.prefs.json</code>
    </p>
    <p>The actual setting of the preferences can be shown with
      <br /> &nbsp; &nbsp; &nbsp; &nbsp; <code>http://{server}:{port}/prefs</code> &nbsp; or &nbsp;
      <code> {RPIname}:{port}/prefs</code>
    </p>
    <p>Then it is <strong><em>piSchedule</em></strong> to restart, see above.</p>
    <p>Show the current preferences on the WEB page with:
      <br /> &nbsp; &nbsp; &nbsp; &nbsp; <code>http://{server}:{port}/prefs</code> &nbsp; or &nbsp;
      <code> {RPIname}:{port}/prefs</code>
    </p>

    <h4>Location data - sunrise / sunset</h4>

    <p><em>piSchedule</em> calculates the daily times for sunrise and sunset from the installation location of the RPI using the Internet access (IP code) or geo-coordinates (latitude / longitude).</p>

    <p>The geo coordinates are made available using the following methods:<br />
      &nbsp; &nbsp; ▸ Internet service http://ipinfo.io/</p>

    <p>If the GeoCoordinates should have been determined only inaccurately, Longitude/Latitude can also be specified manually. For this purpose the parameters are to be specified with "geoCoordinates".
 (See also below)</p>

    <p>Extract from the preference file for the determination of sunrise and sunset</p>
    <pre><code>    "latitude": "52.758",
    "longitude": "5,192",
    "sunset": "2020-09-15 17:18:18",
    "sunrise": "2020-09-15 07:13:43",</code></pre>


------------------

    <h4 id="pischedule-language-setting">Language setting</h4>
    <p><strong><em>piSchedule</em></strong> supports the languages German (DE) and English (EN) for the browser web GUI. </p>
    <p>Other languages for the web GUI can be supported by extending the file
      <em>~/schedulePlus3/piStrings.json</em>. <br />
      Such an additional language/file extension will be activated directly with a
      restart of <em>piSchedule</em>
    <p><em><small><strong>Note</em></strong>
      <br />The documentation for other languages is stored in the download structure
      of the application. (Please request support from the author)
      </small>
    </p>
    </p>


    <h4>Set Preferences</h4>
    <p>Certain <strong><em>piSchedule</em></strong> preference values can be changed directly via the WEB interface using
      <br /> &nbsp; &nbsp; &nbsp; &nbsp; <code>http://{server}:{port}/{prefs}?{wert}</code>:
    </p>
    <ul>
      <li>Language Setting - <code>/locale?DE|EN</code></li>
      <li>GeoCoordinates - <code>/geoCoordinates?{longitude}, {latitude}</code></li>
      <li>Basic setting for Schedule INI.File - <code>/iniFile?{fileName}</code></li>
    </ul>
    <p><em><small><strong>Note</strong> &nbsp; &nbsp; The sign | stands for alternative information,
          eg DE or EN <br />
          Umlaute are not permitted (only ASCII characters);
          e.g. replace &nbsp; <code>ü</code>&nbsp; mit&nbsp; <code>ue</code>  etc. </small></em>
    </p>


    <h4 id="pischedule-logging"><em>piSchedule</em> Logging</h4>
    <p>The weekday log files (Monday.log ... Sunday.log) show the executed jobs with
      <br /><code>https://{server}:{port}/logs</code>
      <br />
      <strong><em>piSchedule</em></strong> writes two log-files in the directory <code>~/schedulePlus3/logs/</code>.
    </p>

    <p>Listing on the Console with:</p>
    <ul>
      <li><code>cat ~/schedulePlus3/logs/piInfo.log</code>
        -- messages for the calculations of the Day Schedule/Jobs an of the browser calls</li>
      <li><code>cat ~/schedulePlus3/logs/piSystem.log</code>
        -- System relevant messages, also error messages </li>
    </ul>
    <p><em><small>See also log-files with '.log.1' und '.log.2'</small></em>
    </p>
    <hr>


    <h4 id="contributions-and-acknowledgement">Contributions and Acknowledgement</h4>
    <p>Thanks to <a href="http://www.linux-tips-and-tricks.de/en">framp</a>!
      He helped with feedback, testing and his Linux experience to
      improve the program and functionality.
    </p>





  </div> <!-- class container -->
  <!-- $$$content$$$ -->

  <hr />
  <div id="pFooter">
    <p align="center" id="freeProjectDE" style="display:block">
      &copy; gNeandr &nbsp; &nbsp; -- &nbsp; &nbsp;
      <strong><em>piSchedule</em></strong> ist ein freies Open Source Projekt &nbsp; &nbsp; -- &nbsp; &nbsp; Feel free to use it.
    </p>

    <p align="center" id="donationDE" style="display:block">
      <b><a href='https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&amp;hosted_button_id=N3HLSJP5CVLSS' title='Danke für ihre Spende und die Benutzung von Paypal'>
          <img alt='Donate button ' src='https://neandr.github.io/piSchedule/pic.Donate-40g.png' style='width:20px' />
          &nbsp; &nbsp; Spende was <i>piSchedule</i> Dir wert ist.</a></b>
      <br />
      <a href="https://groups.google.com/forum/#!forum/piSchedule7">Kommentare, Fragen und Rückmeldungen im <i>piSchedule</i>
        <strong>Forum</strong></a>
    </p>
  </div>

  <!-- ..........  Google Translate  .................... -->
  <script type="text/javascript">
    function googleTranslateElementInit() {
      new google.translate.TranslateElement({
          pageLanguage: 'de',
          includedLanguages: 'en,de,fr,nl,es',

          layout: google.translate.TranslateElement.InlineLayout.SIMPLE
        },
        'google_translate_element');
    }
  </script>
  <script type="text/javascript" src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit">
  </script>
  <style>
    .goog-te-banner-frame.skiptranslate {
      display: none !important;
    }

    body {
      top: 0px !important;
    }
  </style>
  <!-- ..........  Google Translate  .................... -->


</body>

</html>
